function bindUpdateContact(n){return{Firstname:n("#txtFirstName").val(),LastName:n("#txtLastName").val(),JobTitle:n("#txtJobTitle").val(),PrimaryEmailAddress:n("#txtEmail").html(),MobilePhoneNumber:n("#txtContactNumber").val(),BusinessPhoneNumber:n("#txtBusinessNumber").val(),JobRole:n("#ddlRole option:selected").val(),TimeInIndustry:n("#ddlAgeIndustry option:selected").val(),AmrodBranch:n("#ddlBranch option:selected").val(),Gender:n("#ddlGender option:selected").val(),Birthday:n("#txtBirthday").val(),PrimaryAddressUnitNoAndComplex:n("#txtUnitNumber").val(),StreetName:n("#txtStreetName").val(),SuburbCode:n("#txtSuburbCode").val(),PrimaryAddressCity:n("#txtCity").val(),PrimaryAddressStateOrProvince:n("#txtProvince").val(),PrimaryAddressPostalCode:n("#txtPostalCode").val(),PrimaryAddressCountry:n("#ddlCountry option:selected").val(),DoNotSendMarketingMaterials:n("#ckMakertingMailer").is(":checked"),PrimaryAddressStreetLine2:n("#txtStreetAddress2").val(),PrimaryAddressStreetLine1:n("#txtStreetAddress").val(),PrimaryAddressStreetLine3:n("#txtSuburbCode").val(),ODataETag:n("#ODataETag").val(),ContactId:n("#ContactId").val(),PrimaryAddressId:n("#PrimaryAddressId").val(),Updated:!0,Channel:"Website Popup",Password:n("#txtPassword").val(),ConfirmPass:n("#txtConfirmPass").val()}}function BindContacts(n){var i=n.TheData,v,o,s,h,c,l;let t=i.DynamicsContacts;v=null;$("#lblName").text(t.Firstname);$("#txtFirstName").val(t.Firstname);$("#txtLastName").val(t.LastName);$("#txtStreetAddress2").val(t.PrimaryAddressStreetLine2);$("#txtStreetAddress").val(t.PrimaryAddressStreetLine1);$("#txtEmail").html(t.PrimaryEmailAddress);$("#txtContactNumber").val(t.MobilePhoneNumber);$("#txtBusinessNumber").val(t.BusinessPhoneNumber);$("#ddlBranch").val(t.AmrodBranch);$("#txtBirthday").val(i.BirthDay);$("#txtUnitNumber").val(t.PrimaryAddressUnitNoAndComplex);$("#txtSuburbCode").val(t.PrimaryAddressStreetLine3);$("#txtCity").val(t.PrimaryAddressCity);$("#txtProvince").val(t.PrimaryAddressStateOrProvince);$("#txtPostalCode").val(t.PrimaryAddressPostalCode);$("#txtCountry").val(t.PrimaryAddressCountry);$("#ddlCountry").val(t.PrimaryAddressCountry);$("#ODataETag").val(t.ODataETag);$("#ContactId").val(t.ContactId);$("#PrimaryAddressId").val(t.PrimaryAddressId);$("#ckMakertingMailer").prop("checked",t.DoNotSendMarketingMaterials);$("#lblTierStatus").html(i.AccountStatus);$("#lblCompanyName").html(i.CompanyName);$("#lblAccountNumber").html(i.AccountNumber);$("#txtPassword").val(i.Password);$("#txtConfirmPass").val(i.Password);o=_.sortBy(i.Role.Values,n=>n.Value==t.JobRole);let r=$("#ddlRole");t.JobRole==0&&r.append($('<option  selected="selected" style="font-weight: bold"><\/option>').text("Please select your job role").val("-1"));$.each(o,function(n,i){let u="";u=t.JobRole==i.Value?"<option selected='selected'><\/option>":"<option><\/option>";r.append($(u).val(i.Value).text(i.Label))});r.trigger("chosen:updated");s=_.sortBy(i.Branchies.Values,n=>n.Value==t.AmrodBranch);let u=$("#ddlBranch");t.AmrodBranch==0&&u.append($('<option  selected="selected" style="font-weight: bold"><\/option>').text("Please select a branch").val("-1"));$.each(s,function(n,i){let r="";r=t.AmrodBranch==i.Value?"<option selected='selected'><\/option>":"<option><\/option>";u.append($(r).val(i.Value).text(i.Label))});u.trigger("chosen:updated");h=_.sortBy(i.Gender.Values,n=>n.Value==t.Gender);let f=$("#ddlGender");t.Gender==0&&f.append($('<option  selected="selected" style="font-weight: bold"><\/option>').text("Please select your gender").val("-1"));$.each(h,function(n,i){let r="";r=t.Gender==i.Value?"<option selected='selected'><\/option>":"<option><\/option>";f.append($(r).val(i.Value).text(i.Label))});f.trigger("chosen:updated");c=_.sortBy(i.TimeInIndustry.Values,n=>n.Value==t.TimeInIndustry);let e=$("#ddlAgeIndustry");t.TimeInIndustry==0&&e.append($('<option selected="selected" style="font-weight: bold"><\/option>').text("Please select years of experience in industry").val("-1"));$.each(c,function(n,i){let r="";r=t.TimeInIndustry==i.Value?"<option selected='selected'><\/option>":"<option><\/option>";e.append($(r).val(i.Value).text(i.Label))});e.trigger("chosen:updated");l=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Austrian Empire*","Azerbaijan","Baden*","Bahamas, The","Bahrain","Bangladesh","Barbados","Bavaria*","Belarus","Belgium","Belize","Benin (Dahomey)","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Brunswick and Lüneburg","Bulgaria","Burkina Faso (Upper Volta)","Burma","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Cayman Islands, The","Central African Republic","Central American Federation*","Chad","Chile","China","Colombia","Comoros","Congo Free State, The","Costa Rica","Cote d’Ivoire (Ivory Coast)","Croatia","Cuba","Cyprus","Czechia","Czechoslovakia","Democratic Republic of the Congo","Denmark","Djibouti","Dominica","Dominican Republic","Duchy of Parma, The*","East Germany (German Democratic Republic)*","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini","Ethiopia","Federal Government of Germany (1848-49)*","Fiji","Finland","France","Gabon","Gambia, The","Georgia","Germany","Ghana","Grand Duchy of Tuscany, The*","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Hanover*","Hanseatic Republics*","Hawaii*","Hesse*","Holy See","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kingdom of Serbia/Yugoslavia*","Kiribati","Korea","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Lew Chew (Loochoo)*","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mecklenburg-Schwerin*","Mecklenburg-Strelitz*","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Namibia","Nassau*","Nauru","Nepal","Netherlands, The","New Zealand","Nicaragua","Niger","Nigeria","North German Confederation*","North German Union*","North Macedonia","Norway","Oldenburg*","Oman","Orange Free State*","Pakistan","Palau","Panama","Papal States*","Papua New Guinea","Paraguay","Peru","Philippines","Piedmont-Sardinia*","Poland","Portugal","Qatar","Republic of Genoa*","Republic of Korea (South Korea)","Republic of the Congo","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Schaumburg-Lippe*","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands, The","Somalia","South Africa","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Tajikistan","Tanzania","Texas*","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Two Sicilies*","Uganda","Ukraine","Union of Soviet Socialist Republics*","United Arab Emirates, The","United Kingdom, The","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Württemberg*","Yemen","Zambia","Zimbabwe"];let a=$("#ddlCountry");t.PrimaryAddressCountry==null?a.append($('<option  selected="selected" style="font-weight: bold"><\/option>').text("Please select a country").val("-1")):a.append($('<option  selected="selected" style="font-weight: bold"><\/option>').text(t.PrimaryAddressCountry).val(t.PrimaryAddressCountry));$("#ddlCountry").select2({data:l});EmptyFields(n)}function EmptyFields(n){var t=n.TheData;let i=t.DynamicsContacts;$("#txtFirstName").val()===""&&$("#txtFirstName").addClass("empty");$("#txtLastName").val()===""&&$("#txtLastName").addClass("empty");$("#txtStreetAddress").val()===""&&$("#txtStreetAddress").addClass("empty");$("#txtStreetAddress2").val()===""&&$("#txtStreetAddress2").addClass("empty");$("#txtContactNumber").val()===""&&$("#txtContactNumber").addClass("empty");$("#txtBusinessNumber").val()===""&&$("#txtBusinessNumber").addClass("empty");$("#txtBirthday").val()===""&&$("#txtBirthday").addClass("empty");$("#txtUnitNumber").val()===""&&$("#txtUnitNumber").addClass("empty");$("#txtSuburbCode").val()===""&&$("#txtSuburbCode").addClass("empty");$("#txtCity").val()===""&&$("#txtCity").addClass("empty");$("#txtProvince").val()===""&&$("#txtProvince").addClass("empty");$("#txtPostalCode").val()===""&&$("#txtPostalCode").addClass("empty");$("#ddlCountry option:selected").val()==="-1"&&$("#divCountry a").css("border-color","#cee6fa");$("#ddlAgeIndustry option:selected").val()==="-1"&&$("#divAgeIndustry a").css("border-color","#cee6fa");$("#ddlBranch option:selected").val()==="-1"&&$("#divBranch a").css("border-color","#cee6fa");$("#ddlRole option:selected").val()==="-1"&&$("#divRole a").css("border-color","#cee6fa");$("#ddlGender option:selected").val()==="-1"&&$("#divGender a").css("border-color","#cee6fa")}var DynamicsAccountContacts=function(n){var t={ContactDetails:function(){n.ajax({headers:{},url:"AjaxHandlers/DynamicsContactHandler.aspx",data:{a:"GetDynamicAccountContact"},dataType:"json",cache:!1,async:!0,beforeSend:function(){n("#dynamicsLoader").show()},complete:function(){n("#dynamicsLoader").hide()},success:function(t){t.TheData!==null&&BindContacts(t,n)},error:function(t){n("#dynamicsLoader").hide();alertMessage(t.responseJSON.Error)}})},UpdateContactDetails:function(){var t=bindUpdateContact(n),i=!0,r=!0;t.Firstname===""&&(i=!1,n("#txtFirstName").css("border-color","#843534"),n("#divfirstname").attr("class","form-group has-error"));t.LastName===""&&(i=!1,n("#txtLastName").css("border-color","#843534"),n("#divLastname").attr("class","form-group has-error"));t.MobilePhoneNumber===""&&(i=!1,n("#txtContactNumber").css("border-color","#843534"),n("#divContactNumber").attr("class","form-group has-error"));t.BusinessPhoneNumber===""&&(i=!1,n("#txtBusinessNumber").css("border-color","#843534"),n("#divBusinessNumber").attr("class","form-group has-error"));t.PrimaryAddressStreetLine3===""&&(i=!1,n("#txtSuburbCode").css("border-color","#843534"),n("#divSuburbCode").attr("class","form-group has-error"));t.PrimaryAddressCity===""&&(i=!1,n("#divCity").css("border-color","#843534"),n("#txtCity").attr("class","form-group has-error"));t.PrimaryAddressStateOrProvince===""&&(i=!1,n("#txtProvince").css("border-color","#843534"),n("#divProvince").attr("class","form-group has-error"));t.PrimaryAddressCountry==="-1"&&(i=!1,n("#Country").css("border-color","#843534"),n("#divCountry").attr("class","form-group has-error"));t.PrimaryAddressPostalCode===""&&(i=!1,n("#txtPostalCode").css("border-color","#843534"),n("#divPostalCode").attr("class","form-group has-error"));t.TimeInIndustry==="-1"&&(r=!1,alertMessage("Please select your time in industry."),n("#divAgeIndustry").attr("class","form-group has-error"));t.AmrodBranch==="-1"&&(r=!1,n("#divBranch").attr("class","form-group has-error"),alertMessage("Please select your nearest  branch."));t.JobRole==="-1"&&(r=!1,alertMessage("Please select your role."),n("#divRole").attr("class","form-group has-error"));t.Gender==="-1"&&(r=!1,alertMessage("Please select your gender."),n("#divGender").attr("class","form-group has-error"));t.Password!==t.ConfirmPass&&(r=!1,alertMessage("Passwords do not match."),n("#divPassword").attr("class","form-group has-error"),n("#divConfirmPass").attr("class","form-group has-error"));(t.Password==""||t.ConfirmPass=="")&&(r=!1,alertMessage("Password fields cannot be empty."),n("#divPassword").attr("class","form-group has-error"));i?r&&n.ajax({headers:{},url:"AjaxHandlers/DynamicsContactHandler.aspx",data:{a:"UpdateDynamicAccountContact",AccountContact:JSON.stringify(t),Password:t.Password,ConfirmPass:t.ConfirmPass},method:"POST",dataType:"json",cache:!1,async:!0,beforeSend:function(){n("#dynamicsLoader").show()},complete:function(){n("#dynamicsLoader").hide()},success:function(){n("#dynamicsCustomerCodeUpdateDialog").modal("hide");alertMessage("Thank you. Your contact details have been successfully updated.");n("#otherMessageDialog").on("hide.bs.modal",function(){window.location.href="Default.aspx"})},error:function(t){n("#dynamicsLoader").hide();t.responseJSON.Error==="The version of the existing record doesn't match the RowVersion property provided"?alertMessage("Your contacts details are already saved."):alertMessage(t.responseJSON.Error)}}):alertMessage("Please confirm that all of the required fields have valid values for an existing address.")}},i={Initialise:function(){t.ContactDetails()},Update:function(){t.UpdateContactDetails()}};return{Functions:i}}(jQuery);